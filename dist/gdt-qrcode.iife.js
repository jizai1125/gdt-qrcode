var GdtQRCode=function(s,i){"use strict";function C(t,d=!0){const e=new URLSearchParams;for(const a in t)if(Object.hasOwn(t,a)){const c=t[a];(!d||c!=null)&&e.append(a,c)}return e.toString()}const S=/^(\d|\.)+$/;function p(t,d="px"){return typeof t=="number"?`${t}${d}`:typeof t=="string"&&S.test(t)?`${t}${d}`:t}const y="https://login-pro.ding.zj.gov.cn",g={domain:y,url:`${y}/oauth2/auth.htm?response_type=code&scope=get_user_info&authType=QRCODE&embedMode=true`,width:"100%",height:320,showLogo:!0,onlyShowCode:!1,blockLine:!0};function w(t,d){if(!t){console.warn("[gdt-qrcode]","dom is not exist");return}const e={config:d,dom:t,domClassName:"gdt-qrcode-wrapper",iframe:void 0,url:void 0,render:c,update:l,updateUrl:h,updateStyle:f,messageHandler:a};e.render(),window.addEventListener("message",a);function a(n){var u,o;n.origin.match(e.config.domain)&&((o=(u=e.config).onScanned)==null||o.call(u,n.data.code,n.data))}function c(){e.dom.innerHTML="",e.dom.classList.add(e.domClassName);const n=document.createElement("iframe");e.iframe=n,e.update(),e.dom.appendChild(n)}function l(n){e.iframe&&(r(n),e.updateUrl(),e.updateStyle())}function h(n){e.iframe&&(n&&r({url:n}),e.url=m(),e.iframe.src=e.url)}function f(n){if(!e.iframe)return;const{width:u,height:o,showLogo:b,onlyShowCode:R,blockLine:U}=r(n);e.iframe.frameBorder="0",e.iframe.width=p(u),e.iframe.height=p(o),e.iframe.style.marginTop=R?"-80px":b?"0":"-40px",e.dom.style.display=U?"block":"inline-block",e.dom.style.overflow="hidden"}function r(n){return e.config={...g,...e.config,...n},e.config}function m(){const{clientId:n,redirectUri:u,url:o}=e.config;return typeof o=="function"?o(e.config):`${o}&${C({client_id:n,redirect_uri:u})}`}return e}function L(){return Math.random().toString(32).substring(2)}const _=i.defineComponent({__name:"QRCode",props:i.mergeDefaults({clientId:{},redirectUri:{},domain:{},url:{type:[String,Function]},width:{},height:{},blockLine:{type:Boolean},showLogo:{type:Boolean},onlyShowCode:{type:Boolean},onScanned:{type:Function}},g),emits:["scanned"],setup(t,{emit:d}){const e=t,a=d,c=i.ref(),l=i.ref();i.watch([()=>e.url,()=>e.clientId,()=>e.redirectUri],([f,r,m])=>{var n;(n=l.value)==null||n.update({url:f,clientId:r,redirectUri:m})}),i.watch([()=>e.width,()=>e.height,()=>e.onlyShowCode,()=>e.showLogo,()=>e.blockLine],([f,r,m,n,u])=>{var o;(o=l.value)==null||o.updateStyle({width:f,height:r,onlyShowCode:m,showLogo:n,blockLine:u})});function h(f,r){a("scanned",f,r)}return i.onMounted(()=>{l.value=w(c.value,{...e,onScanned:h})}),i.onUnmounted(()=>{l.value&&window.removeEventListener("message",l.value.messageHandler)}),(f,r)=>(i.openBlock(),i.createElementBlock("div",{ref_key:"qrcodeContainerRef",ref:c},null,512))}});return s.QRCode=_,s.defaultConfig=g,s.genUuid=L,s.initQRCode=w,Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),s}({},Vue);
